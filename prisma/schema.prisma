// This is your Prisma schema file,
// learn more about it in the docs: https://pris.ly/d/prisma-schema

generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "postgresql"
  url      = env("DATABASE_URL")
}

model User {
  id                Int                 @id @default(autoincrement())
  name              String              @db.VarChar(100)
  email             String              @db.Text
  password          String              @db.Text
  role              Role
  Apartament        Apartament?         @relation(fields: [apartamentId], references: [id])
  apartamentId      Int?
  ParkingLot        ParkingLot?
  OwnerToken        OwnerToken?
  Report            Report[]
  RentSpace         RentSpace[]
  MaintenaceRequest MaintenaceRequest[]
}

model Apartament {
  id                Int                 @id @default(autoincrement())
  name              String              @db.VarChar(20)
  bedrooms_amount   Int
  bathrooms_amount  Int
  suits_amount      Int
  User              User[]
  MaintenaceRequest MaintenaceRequest[]
}

model ParkingLot {
  id     Int    @id @default(autoincrement())
  name   String @db.VarChar(20)
  User   User?  @relation(fields: [userId], references: [id])
  userId Int    @unique
}

model OwnerToken {
  id     Int    @id @default(autoincrement())
  token  String @db.Text
  User   User   @relation(fields: [userId], references: [id])
  userId Int    @unique
}

model Report {
  id          Int     @id @default(autoincrement())
  description String  @db.Text
  User        User    @relation(fields: [userId], references: [id])
  userId      Int
  solved      Boolean @default(false)
}

model LeisureSpace {
  id         Int         @id @default(autoincrement())
  name       String      @db.VarChar(100)
  daily_rent Int
  capacity   Int
  RentSpace  RentSpace[]
}

model RentSpace {
  id             Int          @id @default(autoincrement())
  day_rent       DateTime     @db.Timestamp()
  User           User         @relation(fields: [userId], references: [id])
  userId         Int
  LeisureSpace   LeisureSpace @relation(fields: [leisureSpaceId], references: [id])
  leisureSpaceId Int
}

model MaintenaceRequest {
  id           Int        @id @default(autoincrement())
  description  String     @db.Text
  solved       Boolean    @default(false)
  User         User       @relation(fields: [userId], references: [id])
  userId       Int
  Apartament   Apartament @relation(fields: [apartamentId], references: [id])
  apartamentId Int
}

enum Role {
  OWNER
  RESIDENT
}
